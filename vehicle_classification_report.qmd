---
title: "Kjøretøyklassifisering"
format: 
  pdf:
    toc: true
    number-sections: true
    df-print: kable
    toc-title: Innhold
    mainfont: "Arial"
    include-in-header:
      text: |
        \newfontfamily\sectionfont[Color=ed9300]{Arial}
        \newfontfamily\subsectionfont[Color=444f55]{Arial}
        \newfontfamily\subsubsectionfont[Color=ed9300]{Arial}
        \addtokomafont{section}{\sectionfont}
        \addtokomafont{subsection}{\subsectionfont}
        \addtokomafont{subsubsection}{\subsubsectionfont}
        \usepackage[font=small,textfont=it,labelsep=period]{caption}
        \let\oldsection\section
        \renewcommand\section{\clearpage\oldsection}
    papersize: a4
crossref: 
  tbl-title: "Tabell"
  lot-title: "Tabeller"
  tbl-prefix: "tabell"
  fig-title: "Figur"
  lof-title: "Figurer"
  fig-prefix: "figur"
  title-delim: "."
  sec-prefix: "kapittel"
---


```{r}
#| label: setup
#| include: false
#| echo: false

base::Sys.setlocale(locale = "nb.utf8")
library(tidyverse)
library(knitr)
library(flextable)

knitr::opts_chunk$set(
  echo = FALSE,
  warning = FALSE,
  message = FALSE,
  error = FALSE,
  cache = FALSE,
  dpi = 150,
  dev = "ragg_png",
  tab.topcaption = TRUE
  )

flextable::set_flextable_defaults(
  font.size = 8,
  decimal.mark = ",",
  big.mark = " ",
  na_str = ""
)
```

```{r}
#| label: data
#| include: false

n_vehicles <- readr::read_rds("H:/Programmering/R/trafikkdata/vehicle_classification_data/n_vehicles.rds")
classified_vehicles <- readr::read_csv2("kjoretoyregisteret/kjoretoy_filtrert.csv")

vehicles_5.4_grouped <- read.csv2("kjoretoyregisteret/vehicles_5.4_grouped.csv")
vehicles_5.6_grouped <- read.csv2("kjoretoyregisteret/vehicles_5.6_grouped.csv")
vehicles_5.8_grouped <- read.csv2("kjoretoyregisteret/vehicles_5.8_grouped.csv")
vehicles_6.0_grouped <- read.csv2("kjoretoyregisteret/vehicles_6.0_grouped.csv")
vehicles_relative <- read.csv2("kjoretoyregisteret/vehicles_relative.csv")

classes_joined <- readr::read_csv2("kjoretoyregisteret/classes_joined.csv")

norsikt_rtdce_mapping <- readr::read_csv2("kjoretoyregisteret/norsikt_rtdce_mapping.csv")
```


\listoftables
\listoffigures
\newpage


# Sammendrag {.unnumbered}
Klassifisering av motorkjøretøy kan gjøres på ulike måter avhengig av hvilket formål det skal tjene. Dette dokumentet tar for seg sammenhengen mellom klassene i disse klassifiseringssystemene:

- lengdeklassifisering (trafikkdata)
- kjøretøygrupper definert i kjøretøyforskriften
- nordisk klassifiseringsstandard (NorSIKT)

En analyse av sammenhengen mellom kjøretøylengde og Kjøretøyforskriftens grupper viser at det ikke i alle tilfeller er entydige skiller mellom kjøretøygruppene og de tradisjonelle lengdeklassene. En tilsvarende oversikt over sammenhengen mellom kjøretøys tillatte totalvekt og Kjøretøyforskriftens grupper viser at disse to er entydig definert foruten noen få unntak.

Videre viser en analyse av sammenhengen mellom kjøretøylengde og tillatt totalvekt at skillet mellom korte og lange kjøretøy burde vært ved 7,5 m dersom grensen skal passe best til skillet mellom lette og tunge ved 3,5 tonn tillatt totalvekt. Likevel er forskjellen fra den tradisjonelle lengdegrensen på 5,6 m relativt liten, og ikke av særlig betydning.

Til slutt er det sett på sammenhengen mellom alle klassifiseringssystemene for å se hvilke klassekoder som tilsvarer hverandre. I trafikkregistreringer vil hvert kjøretøy bli forsøkt klassifisert ut fra de data som   trafikkregistreringsutstyret klarer å samle inn via sensorikk. Hvilke klasser som benyttes i slike registreringer kan variere mellom utstyrsleverandører. Dette dokumentet beskriver sammenhengen mellom slike utstyrsspesifikke klassifiseringer og de ovenfor nevnte klassifiseringssystemer. Dersom NorSIKT-systemet skal benyttes, viser det seg å være nivå 3 som passer best med data fra dagens trafikkregistreringsutstyr som benyttes i Trafikkdatasystemet.


# Bakgrunn
I trafikkdatasammenheng har det i mange år vært vanlig å klassifisere motorkjøretøy basert på _målt_ lengde. En slik lengdemåling foretas automatisk når et kjøretøy blir registrert av sensorer når det passerer et trafikkregistreringspunkt. Slike trafikkregistreringspunkt er plassert på offentlig veg og foretar registrering av alle passerende kjøretøy uten at det påvirker trafikken.

Trafikkdata samles inn for ulike statistikkformål, og i mange sammenhenger er det relevant å dele kjøretøy inn i to vektklasser: lette og tunge. Dette er basert på skillet for tillatt totalvekt på 3,5 tonn, slik det er definert i Kjøretøyforskriften, som er utgangspunktet for blant annet førerkrav og avgiftsnivå. Den automatisk målte lengden er typisk brukt til å dele inn kjøretøy i to tilsvarende klasser, korte og lange, hvor skillet er satt ved 5,6 m.

Denne rapporten tar for seg sammenhengen mellom den tradisjonelle lengdeklassifiseringen og kjøretøygrupperingen slik den er beskrevet i Kjøretøyforskriften. Videre sammenlignes dette med en felles nordisk standard for kjøretøyklassifisering (NorSIKT), samt klassifiseringen som fås fra trafikkregistreringsutstyret som benyttes til innsamling av trafikkdata i Norge.

Sammenhenger mellom lengde- og kjøretøyklassifisering er basert på tekniske data fra Kjøretøyregisteret.


# Lengdeklassifisering
Den tradisjonelle lengdeklassifiseringen baserer seg på automatisk målt lengde ved hjelp av trafikkregistreringsutstyr. Den har to nivåer.

Nivå 1 har to klasser:

  - kortere enn 5,6 m
  - 5,6 m og lengre
  
Nivå 2 har seks klasser:

  - kortere enn 5,6 m
  - fra 5,6 m til 7,6 m
  - fra 7,6 m til 12,5 m
  - fra 12,5 m til 16 m
  - fra 16 m til 24 m
  - fra 24 m

Tidligere var motorsykler angitt som egen klasse, men er nå inkludert i klassen "kortere enn 5,6 m".


# Forskriftenes kjøretøyklassifisering
Det er flere forskrifter som definerer kjøretøyklasser og -betegnelser. Disse er

- Forskrift om tekniske krav og godkjenning av kjøretøy, deler og utstyr (kjøretøyforskriften)
- Forskrift om godkjenning av bil og tilhenger til bil (bilforskriften)
- Forskrift om krav til kjøretøy
- Forskrift om bruk av kjøretøy

Kjøretøyforskriftens § 2-2 lister opp kjøretøygrupper som er inndelt etter tillatt totalvekt og/eller antall sitteplasser. I det følgende er vekt oppgitt i tonn, og det er alltid "tillatt totalvekt" det er snakk om.

Følgende kjøretøygrupper nevnes i forskriften:

  - M1 (personbil, maks 8 sitteplasser)
  - M2 (buss, flere enn 8 sitteplasser, maks 5 tonn)
  - M3 (buss, flere enn 8 sitteplasser, over 5 tonn)
  - N1 (varebil, maks 3,5 tonn)
  - N2 (lastebil, 3,5–12 tonn)
  - N3 (lastebil, over 12 tonn)
  - O1 (tilhenger, maks 0,75 tonn)
  - O2 (tilhenger, 0,75–3,5 tonn)
  - O3 (tilhenger, 3,5–10 tonn)
  - O4 (tilhenger, over 10 tonn)
  - G (terrenggående varianter av gruppene M og N. For eksempel er en ganske vanlig personbil som Toyota Land Cruiser blant disse)
  - L, MCL, MCM, MCT (moped og motorsykkel, med undergrupper som ikke er relevante her)
  - T (traktor, med undergrupper som ikke er relevante her)
  - C (beltetraktor, med undergrupper som ikke er relevante her)
  - R (traktorhenger, med undergrupper som ikke er relevante her)
  - S (utskiftbar trukket maskin, med undergrupper som ikke er relevante her)
  - BB (beltebil)
  - BM (beltemotorsykkel)
  
Det antas at bidraget til trafikkarbeid på offentlig veg fra klassene T, C, R, S, BB og BM kan neglisjeres.

\newpage

Til gruppekodene i kjøretøyforskriften er det nevnt tilhørende gruppebetegnelser. Disse er også definert bilforskriftens § 1-5, som angitt i @tbl-bilforskriften.

::: {#tbl-bilforskriften}
| Gruppekode  | Betegnelse                    |
|-------------|-------------------------------|
| M1          | Personbil                     |
| M2 og M3    | Buss                          |
| N1          | Varebil                       |
| N2 og N3    | Lastebil, trekkvogn           |
| O1 og O2    | Tilhenger ($\leq$ 3 500 kg)   |
| O3 og O4    | Tilhenger (>3 500 kg)         |

: Klassebetegnelser i bilforskriften.

:::

Kjøretøyforskriftens § 2-5 definerer videre noen betegnelser som er relevante her:

- *Tilhenger*: Kjøretøy som hovedsaklig er innrettet for transport av personer eller gods og til å trekkes av motorvogn, herunder kjøretøy gruppe O. Som tilhenger regnes også campingtilhenger.

- *Påhengsvogn*: Tilhenger med en eller flere aksler som er slik konstruert at vertikale krefter kan overføres til tilhengerkoplingen på den trekkende motorvogn.

- *Slepvogn*: Tilhenger med to eller flere aksler som er slik konstruert at vertikale krefter – bortsett fra kreftene p.g.a. tilhengerdragets vekt – ikke kan overføres til tilhengerkoplingen på den trekkende motorvogn.

- *Semitrailer*: Tilhenger med en eller flere aksler og som er slik konstruert at en vesentlig del av tilhengerens vekt bæres av en svingskive montert på den trekkende motorvogn.

- *Vogntog*: Motorvogn med ett eller flere kjøretøy tilkoplet.

Forskrift om krav til kjøretøy gjentar mye av definisjonene fra kjøretøyforskriften, men forskrift om bruk av kjøretøy definerer i § 5-2:

- *Vogntog*: Kjøretøykombinasjon bestående av motorvogn tilkoblet slepvogn, påhengsvogn eller semitrailer.

- *Modulvogntog*: Kjøretøykombinasjoner bestående av motorvogner N2 og N3, tilhengere O3 og O4 og semitrailere O3 og O4 som er i samsvar med dimensjonene i rådsdirektiv 96/53/EF som endret ved direktiv 2002/7/EF.


# Nordisk klassifiseringsstandard (NorSIKT)
De nordiske landene har samarbeidet om et felles klassifiseringssystem, nordisk system for intelligent klassifisering av trafikk (NorSIKT). Systemet inneholder 6 nivåer med ulikt antall klasser. Nivå 1 er triviell og har kun én klasse for motorkjøretøy.

NorSIKT nivå 2 har følgende fem klasser:

  - LMV: light motor vehicle (lett kjøretøy)
  - LMV WC: light motor vehicle with coupled (lett kjøretøy med henger)
  - HMV: heavy motor vehicle (tungt kjøretøy)
  - HMV WC: heavy motor vehicle with coupled (tungt kjøretøy med henger)
  - OMV: other motor vehicle (andre kjøretøy)
  
NorSIKT nivå 3 har følgende sju klasser:

  - MC_MP: motorcycle, moped (motorsykkel, moped)
  - MC_MP WC: motorcycle, moped with coupled (motorsykkel, moped med henger)
  - PC_LGV_LB: personal car, light goods vehicle, light bus (personbil, varebil, lett buss)
  - PC_LGV_LB WC: personal car, light goods vehicle, light bus with coupled (personbil, varebil, lett buss med henger)
  - HMV: heavy motor vehicle (tungt kjøretøy)
  - HMV WC: heavy motor vehicle with coupled (tungt kjøretøy med henger)
  - OMV: other motor vehicle (andre kjøretøy)
  
NorSIKT nivå 4 har følgende 11 klasser:

  - MC_MP: motorcycle, moped (motorsykkel, moped)
  - MC_MP WC: motorcycle, moped with coupled (motorsykkel, moped med henger)
  - PC_LGV: personal car, light goods vehicle (personbil, varebil)
  - PC_LGV WC: personal car, light goods vehicle with coupled (personbil, varebil med henger)
  - LB: light bus (lett buss)
  - LB WC: light bus with coupled (lett buss med henger)
  - HB: heavy bus (tung buss)
  - HB WC: heavy bus with coupled (tung buss med henger)
  - HGV_RT_EMS: heavy goods vehicle, road tractor, other heavy vehicle (lastebil, trekkbil, annet tungt kjøretøy)
  - HGV_RT_EMS WC: heavy goods vehicle, road tractor, other heavy vehicle with coupled (lastebil, trekkbil, annet tungt kjøretøy med henger)
  - OMV: other motor vehicle (andre kjøretøy)


NorSIKT nivå 5 har følgende 14 klasser:

  - MC_MP: motorcycle, moped (motorsykkel, moped)
  - MC_MP WC: motorcycle, moped with coupled (motorsykkel, moped med henger)
  - PC_LGV: personal car, light goods vehicle (personbil, varebil)
  - PC_LGV WC: personal car, light goods vehicle with coupled (personbil, varebil med henger)
  - LB: light bus (lett buss)
  - LB WC: light bus with coupled (lett buss med henger)
  - HB: heavy bus (tung buss)
  - HB WC: heavy bus with coupled (tung buss med henger)
  - HGV: heavy goods vehicle (lastebil)
  - HGV WC: heavy goods vehicle with coupled (lastebil med henger)
  - RT: road tractor (trekkbil)
  - RT WC: road tractor with coupled (trekkbil med semitrailer)
  - EMS: other heavy vehicle (annet tungt kjøretøy)
  - OMV: other motor vehicle (andre kjøretøy)
  
  
NorSIKT nivå 6 har følgende 19 klasser:

  - MP: moped (moped)
  - MC: motorcycle (motorsykkel)
  - MC WC: motorcycle with coupled (motorsykkel med henger)
  - PC: personal car (personbil)
  - PC WC: personal car with coupled (personbil med henger)
  - Small LGV: small light goods vehicle (liten varebil)
  - Small LGV WC: small light goods vehicle with coupled (liten varebil med henger)
  - Big LGV: big light goods vehicle (stor varebil)
  - Big LGV WC: big light goods vehicle with coupled (stor varebil med henger)
  - LB: light bus (lett buss)
  - LB WC: light bus with coupled (lett buss med henger)
  - HB: heavy bus (tung buss)
  - HB WC: heavy bus with coupled (tung buss med henger)
  - HGV: heavy goods vehicle (lastebil)
  - HGV WC: heavy goods vehicle with coupled (lastebil med henger)
  - RT: road tractor (trekkbil)
  - RT WC: road tractor with coupled (trekkbil med semitrailer)
  - EMS: other heavy vehicle (annet tungt kjøretøy)
  - OMV: other motor vehicle (andre kjøretøy)


# Kjøretøyklasser fra trafikkregistreringsutstyr
Kjøretøyklassifiseringen fra trafikkregistreringsutstyret er basert på mer enn bare lengdemåling. Hvilke måleverdier som inngår i klassifiseringen er avhengig av sensortype og leverandør.


## Kontinuerlige registreringer
I perioden fra 2015 til 2018 ble det innfaset nytt utstyr som gir klassifisering. Det er til nå blitt registrert med to ulike apparattyper.

Fra Loop Monitor får vi følgende 11 kjøretøyklasser:

  - 1: motorsykkel
  - 2: personbil
  - 3: personbil med henger
  - 4: varebil
  - 5: varebil med henger
  - 6: buss
  - 71: Liten lastebil
  - 72: Lastebil
  - 8: Vogntog
  - 9: semitrailer
  - 10 eller blank: uklassifisert

Fra EMU3 får vi følgende 6 kjøretøyklasser:

  - LMV1: motorsykkel, moped
  - LMV2: personbil, lett varebil
  - LMV2_WC: personbil, lett varebil med henger
  - HMV: lastebil
  - HMV_WC: lastebil med henger
  - UC/LOOP: uklassifisert
  

## Periodiske registreringer
For periodiske registreringer med faste sensorer benyttes samme apparattyper som for kontinuerlige registreringer. For mobile periodiske registreringer er det fra og med 2019 benyttet to ulike radartyper.

Fra Armadillo får vi følgende kjøretøyklasser:

  - Small: motorsykkel, små biler (omtrent under 4 m)
  - Medium: personbil, varebil (omtrent 4–6 m)
  - Large: buss, lastebil (omtrent over 6 m)
  
TOPO gir klassifisering i følgende kjøretøyklasser:

  - 1: motorsykkel
  - 2: personbil
  - 3: personbil med henger, varebil med henger
  - 4: varebil
  - 5: varebil med henger
  - 6: buss
  - 7: lastebil
  - 8: lastebil med henger
  - 9: trekkbil med semitrailer
  - 10: ukjent


# Sammenhengen mellom lengde og kjøretøygruppe
Datagrunnlaget i denne analysen er teknisk informasjon om dagens bilpark slik Kjøretøyregisteret var 4. september 2021. Her begrenses datagrunnlaget til kjøretøy som har status "registrert", og kjøretøy som er avskiltet eller vraket inngår ikke. Videre er det begrenset til kjøretøy som er registrert første gang etter 1.1.2000, da eldre kjøretøy antas å utgjøre en neglisjerbar andel av dagens kjørte kilometer på det norske vegnettet.

Kjøretøyforskriftens § 2-6 definerer kjøretøylengde som kjøretøyets største utvendige lengde fra forreste til bakerste punkt. Kjøretøylengden som er oppgitt i Kjøretøyregisteret er i noen tilfeller opplagt feil. Disse er her luket ut etter følgende kriterier om lengdeintervall:

  - L 1–4 m
  - M1 2,5–12 m
  - N1 4–10 m
  - N2 3–12 m
  - N3 3–20 m
  - O1 1–10 m
  - O2 2–15 m
  - O3 4–15 m
  - O4 2–25 m

M2 og M3 har bare troverdige lengder. Antall kjøretøy i kjøretøygruppene er vist i @tbl-autosys.

I @fig-plot_length_distributions og @tbl-autosys vises fordeling av lengder per kjøretøygruppe. I @fig-plot_length_distributions går det tydelig fram at klassene L, M1 og N1 stort sett passer inn under 5,6 m. Videre er det ganske bra plass til de fleste i klasse M2 og N2 mellom 5,6 m og 7,6 m. M3 blir delt i to ved skillet på 12,5 m. N3 passer rimelig greit inn mellom 7,6 m og 12,5 m, men disse kjøretøyene har jo ofte henger i tillegg. Foreløpig foreligger ingen informasjon om typiske sammensetninger av bil og henger.

\newpage

```{r}
#| label: tbl-autosys
#| tbl-cap: "Lengdefordeling per kjøretøygruppe."

classified_vehicles |> 
  dplyr::filter(valid_length == TRUE) |> 
  dplyr::summarise(
    min = min(lengde_m),
    median = median(lengde_m, na.rm = TRUE),
    maks = max(lengde_m),
    .by = class
  ) |> 
  dplyr::arrange(class) |> 
  dplyr::left_join(
    n_vehicles,
    by = "class"
  ) |> 
  dplyr::select(
    class, 
    valid_length_TRUE, valid_length_FALSE,
    min, median, maks
  ) |> 
  flextable::flextable() |> 
  flextable::colformat_double(j = 4:6, digits = 1) |> 
  flextable::set_header_labels(
    class = "Kjøretøy-\ngruppe",
    valid_length_TRUE = "Antall\nkjøretøy",
    valid_length_FALSE = "Antall med\nfeil lengde",
    min = "Minste\nlengde\n(m)",
    median = "Median\nlengde\n(m)",
    maks = "Største\nlengde\n(m)"
  ) |> 
  flextable::bold(part = "header") |> 
  flextable::bg(bg = "#ED9300", part = "header")
```

\clearpage

```{r}
#| label: fig-plot_length_distributions
#| fig-cap: "Fordeling av Kjøretøyregisterets lengder per kjøretøygruppe"
#| fig-height: 6

classified_vehicles |> 
  dplyr::filter(valid_length == TRUE)|> 
  ggplot(
    aes(class, lengde_m)
  ) +
  geom_boxplot() +
  theme_bw() +
  scale_y_continuous(
    breaks = c(5.6, 7.6, 12.5, 16, 24)
  ) +
  theme(
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    axis.title.y = element_text(
      margin = margin(t = 0, r = 15, b = 0, l = 0)),
    axis.title.x = element_text(
      margin = margin(t = 15, r = 0, b = 0, l = 0))
    ) +
  labs(
    x = "Kjøretøygruppe i kjøretøyforskriften",
    y = "Kjøretøylengde i Kjøretøyregisteret (m)",
    title = "Fordeling av kjøretøylengde per kjøretøygruppe"
    )
```

\newpage

I @fig-plot_weight_distributions vises fordeling av tillatt totalvekt per klasse. Her er kjøretøy med tillatt totalvekt over 60 tonn utelatt. Disse er for det meste dumpere (N3) som ikke kan kjøre på offentlig veg, eller spesielle hengere (O4, maskinhenger o.l). I M2 er det noen få kjøretøy som er korte og/eller lette (42 som er under 3,5 tonn), men stort sett er alle i M2 både lange og tunge.

```{r}
#| label: fig-plot_weight_distributions
#| fig-height: 6
#| fig-cap: "Fordeling av Kjøretøyregisterets tillatte totalvekter per kjøretøygruppe"

classified_vehicles |> 
  dplyr::filter(
    valid_weight == TRUE,
    vekt_t <= 60
  )|> 
  ggplot(aes(class, vekt_t)) +
  geom_boxplot() +
  #geom_hline(aes(yintercept = 3.5), color = limit_color, alpha = alpha_value) +
  theme_bw() +
  scale_y_continuous(
    breaks = c(3.5, 20, 40, 60)
  ) +
  theme(
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    axis.title.y = element_text(
      margin = margin(t = 0, r = 15, b = 0, l = 0)),
    axis.title.x = element_text(
      margin = margin(t = 15, r = 0, b = 0, l = 0))
  ) +
  labs(
    x = "Kjøretøygruppe i Kjøretøyforskriften",
    y = "Tillatt totalvekt (tonn)",
    title = "Fordeling av tillatt totalvekt per kjøretøygruppe"
  )
```


# Sammenheng mellom lengde og tillatt totalvekt
Datagrunnlaget i denne analysen er det samme som i forrige kapittel, men her brukt til en analyse av sammenhengen mellom kjøretøylengde og klassifisering. Spørsmålet er hvor godt lengdegrensen på 5,6 m passer med skillet mellom lett og tung på 3,5 tonn tillatt totalvekt.

## Relevante kjøretøyklasser
For å se nærmere på grensen mellom lette og tunge, er det tilstrekkelig å inkludere følgende kjøretøygrupper slik de er definert i Kjøretøyforskriften:

  - M1, M1G (personbil, maks 8 sitteplasser)
  - M2, M2G (minibuss, flere enn 8 sitteplasser, maks 5 tonn totalvekt)
  - N1, N1G (lett varebil, maks 3,5 tonn totalvekt)
  - N2, N2G (liten lastebil, totalvekt mellom 3,5 og 12 tonn)

De øvrige klassene inneholder kun lengre kjøretøy.


## Analyse
Ved å kategorisere alle kjøretøy etter kombinasjon av lengde og tillatt totalvekt, kan de deles inn i disse fire kategoriene:

  - Korte og lette: under 5,6 m og opp til og med 3,5 tonn.
  - Korte og tunge: under 5,6 m og over 3,5 tonn.
  - Lange og lette: 5,6 m eller mer og opp til og med 3,5 tonn.
  - Lange og tunge: 5,6 m eller mer og over 3,5 tonn.
  
Den første og siste kategorien er i harmoni med tanken om å skille lette og tunge kjøretøy ved 5,6 m. De to midterste kategoriene er i denne sammenhengen selvmotsigende, og bør helst inneholde så få kjøretøy som mulig.

I de følgende figurene er det vist hvordan kjøretøyene fordeler seg i disse fire kategoriene for ulike valg av lengdegrensen.

```{r}
#| label: fig-combination_plot_function

plot_combination_distribution <- function(vehicle_grouped_df, subtitle_text) {
  
  vehicle_grouped_df |> 
    ggplot2::ggplot(
      aes(kategori, antall)
    ) +
    ggplot2::geom_col(fill = "#ED9300") +
    ggplot2::geom_text(
      aes(label = antall, y = 1e5),
      color = "black",
      position = position_dodge(0.9),
      vjust = 0,
      size = 2
    ) +
    ggplot2::facet_wrap(vars(class)) +
    ggplot2::theme_bw() +
    ggplot2::scale_y_continuous(
      breaks = c(0, 1e6)
    ) +
    ggplot2::theme(
      panel.grid.minor = element_blank(),
      panel.grid.major.x = element_blank(),
      panel.grid.minor.x = element_blank(),
      axis.text.x = element_text(angle = 90),
      axis.title.y = element_text(
        margin = margin(t = 0, r = 15, b = 0, l = 0)),
      axis.title.x = element_text(
        margin = margin(t = 15, r = 0, b = 0, l = 0))
    ) +
    ggplot2::labs(x = "Kategori", y = "Antall kjøretøy") +
    ggplot2::ggtitle(
      "Sammenheng mellom lengde og tillatt totalvekt",
      subtitle = subtitle_text
    )
}
```


```{r}
#| label: fig-bin_5_4
#| fig-cap: "Antall kjøretøy i kombinasjon av vekt og lengde med lengdeskille ved 5,4 m."

plot_combination_distribution(vehicles_5.4_grouped, "Lengdeskille ved 5,4 m")
```

```{r}
#| label: fig-bin_5_6
#| fig-cap: "Antall kjøretøy i kombinasjon av vekt og lengde med lengdeskille ved 5,6 m."

plot_combination_distribution(vehicles_5.6_grouped, "Lengdeskille ved 5,6 m")
```

```{r}
#| label: fig-bin_5_8
#| fig-cap: "Antall kjøretøy i kombinasjon av vekt og lengde med lengdeskille ved 5,8 m."

plot_combination_distribution(vehicles_5.8_grouped, "Lengdeskille ved 5,8 m")
```

```{r}
#| label: fig-bin_6_0
#| fig-cap: "Antall kjøretøy i kombinasjon av vekt og lengde med lengdeskille ved 6,0 m."

plot_combination_distribution(vehicles_6.0_grouped, "Lengdeskille ved 6,0 m")
```